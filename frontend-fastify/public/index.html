<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Micuota - Frontend (Fastify)</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mini.css/3.0.1/mini-default.min.css">
  <style>
    body { font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; padding: 24px; background: #f5f7fb }
    .container { max-width: 980px; margin: 0 auto }
    header { display:flex; align-items:center; justify-content:space-between; gap:12px }
    header h1 { margin: 0; font-size: 1.4rem }
    .grid { display:grid; grid-template-columns: 1fr 1fr; gap: 18px; margin-top: 18px }
    @media (max-width: 800px) { .grid { grid-template-columns: 1fr } }
    .card { background: #ffffff; border-radius: 8px; padding: 18px; box-shadow: 0 6px 18px rgba(20,30,60,0.06) }
    label { font-weight: 600; font-size: 0.9rem }
    .muted { color: #6b7280 }
    pre.result { background: #0f172a; color: #f8fafc; padding: 12px; border-radius:6px; overflow:auto; max-height: 180px }
    .row { display:flex; gap:12px; flex-wrap:wrap; align-items:center }
    .success { color: #065f46 }
    .error { color: #991b1b }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Micuota — Demo</h1>
        <div class="muted">Prueba rápida: registro, login y creación de planes (mock MercadoPago)</div>
      </div>
      <div id="status" class="muted">Cargando configuración...</div>
    </header>

    <main class="grid">
      <section class="card">
        <h3>Onboarding rápido</h3>
        <div class="muted">Sigue los flujos automáticos para crear una cuenta y (si eres profesor) crear un plan.</div>
        <div style="margin-top:12px" class="row">
          <button id="btn-onboard-prof" class="primary">Onboard Profesor</button>
          <button id="btn-onboard-stud">Onboard Alumno</button>
        </div>
        <div style="margin-top:12px">
          <label for="onb-name">Nombre</label>
          <input id="onb-name" placeholder="Nombre completo" />
        </div>
        <div>
          <label for="onb-email">Email</label>
          <input id="onb-email" placeholder="email@ejemplo.com" />
        </div>
        <div>
          <label for="onb-password">Password</label>
          <input id="onb-password" placeholder="Password" type="password" />
        </div>
        <div id="onboard-log" style="margin-top:12px">
          <pre id="onboard-result" class="result" aria-live="polite"></pre>
        </div>
      </section>

      <section class="card">
        <h3>Registro (Onboarding)</h3>
        <div>
          <label for="reg-name">Nombre</label>
          <input id="reg-name" placeholder="Nombre completo" />
        </div>
        <div>
          <label for="reg-email">Email</label>
          <input id="reg-email" placeholder="email@ejemplo.com" />
        </div>
        <div>
          <label for="reg-password">Password</label>
          <input id="reg-password" placeholder="Password" type="password" />
        </div>
        <div>
          <label for="reg-role">Rol</label>
          <select id="reg-role">
            <option value="PROFESOR">PROFESOR</option>
            <option value="ALUMNO">ALUMNO</option>
          </select>
        </div>
        <div class="row">
          <button id="btn-register" class="primary">Registrar</button>
          <button id="btn-clear-register">Limpiar</button>
        </div>
        <pre id="register-result" class="result" aria-live="polite"></pre>
      </section>

      <section class="card">
        <h3>Login</h3>
        <div>
          <label for="login-email">Email</label>
          <input id="login-email" placeholder="email@ejemplo.com" />
        </div>
        <div>
          <label for="login-password">Password</label>
          <input id="login-password" placeholder="Password" type="password" />
        </div>
        <div class="row">
          <button id="btn-login" class="primary">Login</button>
          <button id="btn-logout">Logout</button>
        </div>
        <pre id="login-result" class="result" aria-live="polite"></pre>
      </section>

      <section class="card">
        <h3>Crear Plan (protegido)</h3>
        <div>
          <label for="plan-title">Título</label>
          <input id="plan-title" placeholder="Starter" />
        </div>
        <div>
          <label for="plan-price">Precio</label>
          <input id="plan-price" placeholder="9.99" />
        </div>
        <div>
          <label for="plan-frequency">Frecuencia</label>
          <input id="plan-frequency" placeholder="monthly" value="monthly" />
        </div>
        <div class="row">
          <button id="btn-create-plan" class="primary">Crear Plan</button>
          <button id="btn-clear-plan">Limpiar</button>
        </div>
        <pre id="plan-result" class="result" aria-live="polite"></pre>
      </section>

      <section class="card">
        <h3>Sesión</h3>
        <div id="session-info" class="muted">No autenticado</div>
        <div style="margin-top:12px">
          <button id="btn-show-token">Mostrar token</button>
          <button id="btn-copy-token">Copiar token</button>
          <button id="btn-student-pay" class="primary">Pagar sesión (Alumno demo)</button>
        </div>
        <pre id="token-display" class="result" aria-live="polite"></pre>
      </section>
    </main>

    <footer style="margin-top:18px" class="muted">Usa esta interfaz sólo para pruebas. No guardar secretos aquí.</footer>
  </div>

  <!-- Modal / Alert -->
  <div id="micuota-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.4); align-items:center; justify-content:center; z-index:9999">
    <div style="background:#fff; padding:18px; border-radius:8px; max-width:520px; width:90%; box-shadow:0 10px 30px rgba(0,0,0,0.2);">
      <h3 id="micuota-modal-title">Mensaje</h3>
      <div id="micuota-modal-body" style="margin-top:8px; white-space:pre-wrap; max-height:320px; overflow:auto;"></div>
      <div style="margin-top:12px; text-align:right">
        <button id="micuota-modal-close" class="secondary">Cerrar</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>